<!-- Content Header (Page header) -->
    <div class="box box-solid box-default" style="margin-top: 20px">
        <div class="box-header">
            <h1 style="margin:0">
                Singleton
                <small>its for javascript natives...</small>
            </h1>
        </div>

        <!-- Main content -->
        <div class="box-body">
            <div class="alert alert-danger alert-dismissible">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
                It should be noted that while Singleton uses a
                <a href="https://en.wikipedia.org/wiki/Singleton_pattern">singleton pattern</a> you should not use this
                feature
                within a <b>single execution session</b>. Doing so would be considered an anti-pattern. If you're think of
                doing
                this, conciser making your class static and public.
            </div>
            <p class="lead">
                Singleton is a <a href="http://php.net/manual/en/language.oop5.traits.php">mega trait</a> designed to give
                you
                a new semantic style that resembles javascript and allows you to maintain object state between server requests.
            </p>
            <h2>When should I use Singleton?</h2>
            <p>You can attach this trait to any class that does not already have Singleton present in class parents (i.e.
                extended classes).
                The Singleton pattern does not automatically invoke or construct. You must add the <code>const Singleton = true;</code>
                constant and invoke the class object with <code>ExampleClass::getInstance();</code> to achieve this.
            </p>
            <p>Private is more like public in a singleton, this gains in portability
                defined private are accessible to the global scope and overridabillity
                at call time. You may have just cringed if unfamiliar with the php language. However,
                <a href="https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/">I recommend you read this article.</a></p><a href="https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/">

            <h2>Usage</h2>
        </a><div class="box-body bg-gray-light"><a href="https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/">
            <!-- ============================================================= -->
        </a><div class="box-group" id="accordion"><a href="https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/">
            <!-- we are adding the .panel class so bootstrap.js collapse plugin detects it -->
        </a><div class="panel box box-solid box-default"><a href="https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/">
        </a><div class="box-header with-border"><a href="https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/">
        </a><h4 class="box-title"><a href="https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/">
        </a><a class="text-black collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="false">
            #ExampleClass.php
        </a>
        </h4>
        </div>
            <div id="collapseOne" class="panel-collapse collapse in">
                <div class="box-body">
                    <p>The <code>Carbon\Carbon();</code> class wants to start our session <a href="https://carbonphp.com/Session">and will do it by default</a>. This is initiated in our index file so you do not need
                        to run the <code>session_start();</code> function described below. Your session must be active to use the <code>const Singleton = true;</code> directive.
                        When our class destructs its variables will be stored until the next request. Consider the following class definition and how it changes in each preceding
                        file.</p>
                    <pre><code><span style="overflow-x: scroll">&nbsp;<span style="color: #0000BB">&nbsp;session_start</span><span style="color: #007700">();<br><br>class&nbsp;</span><span style="color: #0000BB">ExampleClass<br></span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;</span><span style="color: #0000BB">Singleton</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;</span><span style="color: #0000BB">Singleton&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;turns&nbsp;on&nbsp;data&nbsp;serialization&nbsp;(storage)&nbsp;for&nbsp;all&nbsp;other&nbsp;variables&nbsp;in&nbsp;the&nbsp;class<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;even&nbsp;if&nbsp;implicit,&nbsp;or&nbsp;not&nbsp;directly&nbsp;defined<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$stuff</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(empty(</span><span style="color: #0000BB">$stuff</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$stuff</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">$bar</span><span style="color: #007700">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}</span>

</span></code></pre>
                </div>
            </div>
        </div>
            <div class="panel box box-solid box-info">
                <div class="box-header with-border">
                    <h4 class="box-title">
                        <a class="text-black" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true">
                            #File1.php
                        </a>
                    </h4>
                </div>
                <div id="collapseTwo" class="panel-collapse collapse">
                    <div class="box-body">
                        <p>So as an example, the first request to our server will run this file.</p>
                        <pre><code><span style="overflow-x: scroll">&nbsp;<span style="color: #0000BB">&nbsp;</span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'ExampleClass.php'</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">$object&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ExampleClass</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">(</span><span style="color: #DD0000">'Hello&nbsp;World.'</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;invokes&nbsp;the&nbsp;constructor&nbsp;and&nbsp;Sets&nbsp;the&nbsp;value&nbsp;of&nbsp;foo<br><br></span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bar</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Prints&nbsp;$foo&nbsp;which&nbsp;is&nbsp;=&nbsp;'Hello&nbsp;World'<br><br>//&nbsp;the&nbsp;following&nbsp;is&nbsp;normally&nbsp;not&nbsp;available,&nbsp;but&nbsp;Singleton...<br></span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bar&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'implicit&nbsp;definition'</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;bar&nbsp;was&nbsp;not&nbsp;defined&nbsp;prior,&nbsp;but&nbsp;will&nbsp;hold&nbsp;state&nbsp;between&nbsp;requests<br><br></span><span style="color: #007700">print&nbsp;</span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bar</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Print&nbsp;"Hello&nbsp;World.&nbsp;implicit&nbsp;definition";<br><br></span><span style="color: #007700">die;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;invokes&nbsp;the&nbsp;destructor&nbsp;in&nbsp;Singleton&nbsp;(exit/die&nbsp;is&nbsp;not&nbsp;required)<br></span>

</span></code></pre>
                    </div>
                </div>
            </div>
            <div class="panel box box-solid box-default">
                <div class="box-header with-border">
                    <h4 class="box-title">
                        <a class="text-black" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true">
                            #File2.php
                        </a>
                    </h4>
                </div>
                <div id="collapseThree" class="panel-collapse collapse">
                    <div class="box-body">
                        <p>The second request to our server will run this file.</p>
                        <pre><code><span style="overflow-x: scroll">&nbsp;<span style="color: #0000BB">&nbsp;</span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'ExampleClass.php'</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;following&nbsp;code&nbsp;does&nbsp;not&nbsp;use&nbsp;getInstance(),&nbsp;so&nbsp;our&nbsp;data&nbsp;is&nbsp;not&nbsp;retrieved<br></span><span style="color: #0000BB">$object&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Request</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Don't&nbsp;pass&nbsp;a&nbsp;value&nbsp;to&nbsp;the&nbsp;constructor&nbsp;this&nbsp;time..<br></span><span style="color: #007700">print&nbsp;</span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;prints:&nbsp;''<br><br></span><span style="color: #0000BB">$object&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ExampleClass</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;no&nbsp;variables&nbsp;are&nbsp;set&nbsp;in&nbsp;this&nbsp;constructor<br><br></span><span style="color: #007700">print&nbsp;</span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;still&nbsp;prints:&nbsp;'Hello&nbsp;World'<br><br></span><span style="color: #007700">print&nbsp;</span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;prints:&nbsp;'implicit&nbsp;definition'<br><br></span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bar</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Prints&nbsp;$foo&nbsp;which&nbsp;is&nbsp;=&nbsp;'Hello&nbsp;World'<br><br></span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">superClosure&nbsp;</span><span style="color: #007700">=&nbsp;function&nbsp;()&nbsp;{&nbsp;print&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">PHP_EOL&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">hello</span><span style="color: #007700">;&nbsp;};<br><br></span><span style="color: #0000BB">$object</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">superClosure</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Output:&nbsp;Hello&nbsp;World.&nbsp;We're&nbsp;assigning&nbsp;a&nbsp;new&nbsp;variable.</span>

</span></code></pre>
                    </div>
                </div>
            </div>
            <div class="panel box box-solid box-info">
                <div class="box-header with-border">
                    <h4 class="box-title">
                        <a class="text-black" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="true">
                            #File3.php
                        </a>
                    </h4>
                </div>
                <div id="collapseFour" class="panel-collapse collapse">
                    <div class="box-body">
                        <p>Finally, the third request to our server will run this file.</p>
                        <pre><code><span style="overflow-x: scroll">&nbsp;<span style="color: #0000BB">&nbsp;</span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'ExampleClass.php'</span><span style="color: #007700">;<br><br>class&nbsp;</span><span style="color: #0000BB">Bar&nbsp;</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;</span><span style="color: #0000BB">Singleton</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;we're&nbsp;not&nbsp;storing&nbsp;this&nbsp;classes&nbsp;data&nbsp;on&nbsp;destruct<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">setFoo</span><span style="color: #007700">(</span><span style="color: #0000BB">$foo</span><span style="color: #007700">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**&nbsp;Private&nbsp;is&nbsp;more&nbsp;like&nbsp;public&nbsp;in&nbsp;a&nbsp;singleton,&nbsp;this&nbsp;gains&nbsp;in&nbsp;portability<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;defined&nbsp;private&nbsp;are&nbsp;accessible&nbsp;to&nbsp;the&nbsp;global&nbsp;scope&nbsp;and&nbsp;overridabillity<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;at&nbsp;call&nbsp;time.&nbsp;You&nbsp;may&nbsp;cringe&nbsp;if&nbsp;unfamiliar&nbsp;with&nbsp;the&nbsp;php&nbsp;language.&nbsp;However,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;I&nbsp;recommend&nbsp;you&nbsp;read&nbsp;this&nbsp;article.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@link&nbsp;https://ocramius.github.io/blog/accessing-private-php-class-members-without-reflection/<br>&nbsp;&nbsp;&nbsp;&nbsp;**/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">fooToss</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'A&nbsp;random&nbsp;method&nbsp;implementation,&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br></span><span style="color: #0000BB">$classBar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Bar</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;no&nbsp;need&nbsp;to&nbsp;get&nbsp;the&nbsp;instance&nbsp;this&nbsp;time<br><br></span><span style="color: #0000BB">$classBar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setFoo</span><span style="color: #007700">(</span><span style="color: #DD0000">'hi'</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;following&nbsp;is&nbsp;no&nbsp;mistake<br></span><span style="color: #0000BB">$classBar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fooToss</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;prints:&nbsp;A&nbsp;random&nbsp;method&nbsp;implementation,&nbsp;hi<br><br></span><span style="color: #0000BB">$classBar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fooToss&nbsp;</span><span style="color: #007700">=&nbsp;function()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'hello'</span><span style="color: #007700">;<br>};<br><br></span><span style="color: #0000BB">$classBar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fooToss</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;prints:&nbsp;hello<br><br></span><span style="color: #0000BB">$classBar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fooToss&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'I&nbsp;need&nbsp;a&nbsp;beer'</span><span style="color: #007700">;<br><br>print&nbsp;</span><span style="color: #0000BB">$classBar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fooToss</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;prints:&nbsp;I&nbsp;need&nbsp;a&nbsp;beern<br><br></span><span style="color: #0000BB">$classBar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fooToss</span><span style="color: #007700">();<br><br></span><span style="color: #FF8000">//&nbsp;Lets&nbsp;override&nbsp;a&nbsp;class&nbsp;and&nbsp;namespace,&nbsp;this&nbsp;my&nbsp;be&nbsp;useful&nbsp;when&nbsp;geveloping&nbsp;around&nbsp;interfaces&nbsp;or&nbsp;debugging<br><br></span><span style="color: #0000BB">$request&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Request</span><span style="color: #007700">::</span><span style="color: #0000BB">setInstance</span><span style="color: #007700">(new&nbsp;class&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Takes&nbsp;over&nbsp;the&nbsp;namespace<br><br></span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$bar</span><span style="color: #007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'Fourth&nbsp;exe'</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$oldClass&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Request</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$oldClass</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bar&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$oldClass</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">hello</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>});<br><br></span><span style="color: #FF8000">//&nbsp;after&nbsp;the&nbsp;setInstance()&nbsp;method&nbsp;is&nbsp;complete&nbsp;the&nbsp;previous&nbsp;class&nbsp;will&nbsp;destruct&nbsp;and&nbsp;store&nbsp;in&nbsp;the&nbsp;session<br>//&nbsp;other&nbsp;files&nbsp;may&nbsp;now&nbsp;use&nbsp;the&nbsp;getInstance()&nbsp;to&nbsp;retreive&nbsp;our&nbsp;newly&nbsp;created&nbsp;class<br><br></span><span style="color: #0000BB">$request&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Request</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">();&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Will&nbsp;return&nbsp;the&nbsp;new&nbsp;quickly&nbsp;created&nbsp;class<br><br></span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">superClosure</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;will&nbsp;throw&nbsp;a&nbsp;new&nbsp;Exception<br>//&nbsp;--&nbsp;There&nbsp;is&nbsp;valid&nbsp;method&nbsp;or&nbsp;closure&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;'superClosure'&nbsp;to&nbsp;call<br><br></span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">superClosure&nbsp;</span><span style="color: #007700">=&nbsp;function&nbsp;()&nbsp;{&nbsp;print&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">PHP_EOL&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">hello</span><span style="color: #007700">;&nbsp;};<br><br></span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">superClosure</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Output:&nbsp;Hello&nbsp;World.&nbsp;We're&nbsp;assigning&nbsp;a&nbsp;new&nbsp;variable.<br><br></span><span style="color: #0000BB">$request&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Request</span><span style="color: #007700">::</span><span style="color: #0000BB">setInstance</span><span style="color: #007700">(</span><span style="color: #0000BB">$classBar</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;You&nbsp;getting&nbsp;this?&nbsp;class&nbsp;bar&nbsp;is&nbsp;now&nbsp;retreivable&nbsp;with&nbsp;Request::getInstance()<br><br></span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">superClosure</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;will&nbsp;throw&nbsp;a&nbsp;new&nbsp;Exception<br>//&nbsp;--&nbsp;There&nbsp;is&nbsp;valid&nbsp;method&nbsp;or&nbsp;closure&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;'superClosure'&nbsp;to&nbsp;call</span>

</span></code></pre>
                    </div>
                </div>
            </div>
        </div>
        </div>
        </div>
    </div>
    <div class="box box-solid box-default">
        <div class="box-header">
            <h1 style="margin: 0">The Code
                <small>get it?</small>
            </h1>
        </div>
        <div class="box-body">
            <ol class="breadcrumb">
                <li><a href="https://carbonphp.com/"><i class="fa fa-dashboard"></i> APP_ROOT</a></li>
                <li> Data</li>
                <li> Vendors</li>
                <li> richardtmiles</li>
                <li> carbonphp</li>
                <li> Structure</li>
                <li class="active"> Singleton.php</li>
            </ol>
            <pre><code><span style="overflow-x: scroll"><span style="color: #0000BB"><br><br></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">Carbon</span><span style="color: #007700">;<br><br>use&nbsp;</span><span style="color: #0000BB">Carbon</span><span style="color: #007700">\</span><span style="color: #0000BB">Error</span><span style="color: #007700">\</span><span style="color: #0000BB">ErrorCatcher</span><span style="color: #007700">;<br>use&nbsp;</span><span style="color: #0000BB">Carbon</span><span style="color: #007700">\</span><span style="color: #0000BB">Helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">Serialized</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">/**<br>&nbsp;*&nbsp;Trait&nbsp;Singleton<br>&nbsp;*&nbsp;@package&nbsp;Carbon<br>&nbsp;*<br>&nbsp;*&nbsp;Singeltons&nbsp;are&nbsp;considered&nbsp;an&nbsp;anti-pattern&nbsp;if&nbsp;being&nbsp;utilized&nbsp;during&nbsp;runtime.<br>&nbsp;*&nbsp;This&nbsp;class&nbsp;is&nbsp;designed&nbsp;to&nbsp;give&nbsp;you&nbsp;a&nbsp;lot&nbsp;of&nbsp;features&nbsp;for&nbsp;the&nbsp;quick&nbsp;and&nbsp;dirty.<br>&nbsp;*&nbsp;PHP&nbsp;has&nbsp;magic&nbsp;methods&nbsp;that&nbsp;allow&nbsp;you&nbsp;to&nbsp;do&nbsp;almost&nbsp;anything&nbsp;to&nbsp;the&nbsp;syntax,&nbsp;even<br>&nbsp;*&nbsp;make&nbsp;it&nbsp;more&nbsp;Javascript&nbsp;like.&nbsp;Adding<br>&nbsp;*<br>&nbsp;*&nbsp;class&nbsp;Example&nbsp;{<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;Singleton;<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;Singleton&nbsp;=&nbsp;true;&nbsp;&nbsp;//&nbsp;for&nbsp;auto&nbsp;class&nbsp;serialization<br>&nbsp;*<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;*&nbsp;}<br>&nbsp;*<br>&nbsp;*&nbsp;Will&nbsp;cause&nbsp;serializable&nbsp;variables&nbsp;defined&nbsp;in&nbsp;the&nbsp;class&nbsp;to&nbsp;be&nbsp;stored&nbsp;between&nbsp;sessions.<br>&nbsp;*&nbsp;The&nbsp;Caveat:<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Instead&nbsp;of&nbsp;using&nbsp;the&nbsp;new&nbsp;statement&nbsp;you&nbsp;must&nbsp;use&nbsp;getInstance()&nbsp;in&nbsp;a&nbsp;static&nbsp;context.<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj&nbsp;=&nbsp;Example::getInstance();<br>&nbsp;*<br>&nbsp;*&nbsp;Javascript&nbsp;fans:&nbsp;If&nbsp;singleton&nbsp;is&nbsp;used,&nbsp;the&nbsp;following&nbsp;syntax&nbsp;becomes&nbsp;available<br>&nbsp;*<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;newClosure&nbsp;=&nbsp;function&nbsp;()&nbsp;{&nbsp;print&nbsp;"Closure&nbsp;Binding";&nbsp;};<br>&nbsp;*<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;newClosure();<br>&nbsp;*<br>&nbsp;*&nbsp;This&nbsp;will&nbsp;store&nbsp;the&nbsp;new&nbsp;closure&nbsp;in&nbsp;the&nbsp;methods&nbsp;variable&nbsp;and&nbsp;attempt&nbsp;to&nbsp;run&nbsp;it&nbsp;using<br>&nbsp;*&nbsp;call_user_func_array();<br>&nbsp;*<br>&nbsp;*/<br><br></span><span style="color: #007700">trait&nbsp;</span><span style="color: #0000BB">Singleton<br></span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$storage</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;A&nbsp;Temporary&nbsp;variable&nbsp;for&nbsp;'quick&nbsp;data'<br>&nbsp;&nbsp;&nbsp;&nbsp;/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$methods&nbsp;</span><span style="color: #007700">=&nbsp;array();&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Anonymous&nbsp;Function&nbsp;Declarations<br><br>&nbsp;&nbsp;&nbsp;&nbsp;/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$methodName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$arguments<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Singleton|mixed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">__callStatic</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$arguments&nbsp;</span><span style="color: #007700">=&nbsp;array())<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">Skeleton</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$arguments</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;...$args<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;self<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">newInstance</span><span style="color: #007700">(...</span><span style="color: #0000BB">$args</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">self<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Start&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;class&nbsp;and&nbsp;pass&nbsp;any&nbsp;arguments<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">clearInstance</span><span style="color: #007700">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$reflect&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">ReflectionClass</span><span style="color: #007700">(</span><span style="color: #0000BB">$class&nbsp;</span><span style="color: #007700">=&nbsp;static::class);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$class</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$reflect</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">newInstanceArgs</span><span style="color: #007700">(</span><span style="color: #0000BB">$args</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$class</span><span style="color: #007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;...$args<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;self<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">(...</span><span style="color: #0000BB">$args</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">self<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;see&nbsp;if&nbsp;the&nbsp;class&nbsp;has&nbsp;already&nbsp;been&nbsp;called&nbsp;this&nbsp;run<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(!empty(</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$calledClass&nbsp;</span><span style="color: #007700">=&nbsp;static::class]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;check&nbsp;if&nbsp;the&nbsp;object&nbsp;has&nbsp;been&nbsp;sterilized&nbsp;in&nbsp;the&nbsp;session<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;will&nbsp;invoke&nbsp;the&nbsp;__wake&nbsp;up&nbsp;operator&nbsp;&nbsp;&nbsp;TODO&nbsp;-&nbsp;base64_decode<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">Serialized</span><span style="color: #007700">::</span><span style="color: #0000BB">is_serialized</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">]))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">];<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Start&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;class&nbsp;and&nbsp;pass&nbsp;any&nbsp;arguments<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$class&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">ReflectionClass</span><span style="color: #007700">(</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$class</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">newInstanceArgs</span><span style="color: #007700">(</span><span style="color: #0000BB">$args</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;self&nbsp;$object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;self<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">setInstance</span><span style="color: #007700">(</span><span style="color: #0000BB">self&nbsp;$object</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">self<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][static::class]&nbsp;=&nbsp;</span><span style="color: #0000BB">$object</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Remove&nbsp;the&nbsp;current&nbsp;instance.&nbsp;Also&nbsp;removes&nbsp;any&nbsp;serialized&nbsp;data.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">clearInstance</span><span style="color: #007700">():&nbsp;</span><span style="color: #0000BB">void<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset(</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #0000BB">$calledClass&nbsp;</span><span style="color: #007700">=&nbsp;static::class],&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'Singleton'</span><span style="color: #007700">][</span><span style="color: #0000BB">$calledClass</span><span style="color: #007700">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$methodName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$arguments<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Singleton|mixed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__call</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;array&nbsp;</span><span style="color: #0000BB">$arguments&nbsp;</span><span style="color: #007700">=&nbsp;[])<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Skeleton</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$arguments</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$methodName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$arguments<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Singleton|mixed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;\InvalidArgumentException<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">Skeleton</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$methodName</span><span style="color: #007700">,&nbsp;array&nbsp;</span><span style="color: #0000BB">$arguments&nbsp;</span><span style="color: #007700">=&nbsp;[])<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Have&nbsp;we&nbsp;used&nbsp;addMethod()&nbsp;to&nbsp;override&nbsp;an&nbsp;existing&nbsp;method<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">methods</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</span><span style="color: #0000BB">null&nbsp;</span><span style="color: #007700">===&nbsp;(</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">call_user_func_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">methods</span><span style="color: #007700">[</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$arguments</span><span style="color: #007700">))&nbsp;?&nbsp;</span><span style="color: #0000BB">$this&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Is&nbsp;the&nbsp;method&nbsp;in&nbsp;the&nbsp;current&nbsp;scope&nbsp;(&nbsp;public,&nbsp;protected,&nbsp;private&nbsp;).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Note&nbsp;declaring&nbsp;the&nbsp;method&nbsp;as&nbsp;private&nbsp;is&nbsp;the&nbsp;only&nbsp;way&nbsp;to&nbsp;ensure&nbsp;single&nbsp;instancing<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">method_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</span><span style="color: #0000BB">null&nbsp;</span><span style="color: #007700">===&nbsp;(</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">call_user_func_array</span><span style="color: #007700">(array(</span><span style="color: #0000BB">$this</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">$arguments</span><span style="color: #007700">))&nbsp;?&nbsp;</span><span style="color: #0000BB">$this&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Check&nbsp;to&nbsp;see&nbsp;if&nbsp;we've&nbsp;bound&nbsp;it&nbsp;to&nbsp;the&nbsp;class&nbsp;using&nbsp;an&nbsp;undefined&nbsp;attribute&nbsp;(variable)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(\</span><span style="color: #0000BB">is_callable</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;{</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">}))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addMethod</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;{</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">});<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;\</span><span style="color: #0000BB">call_user_func_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;{</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">},&nbsp;</span><span style="color: #0000BB">$arguments</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;closure&nbsp;binding<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'closures'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'closures'</span><span style="color: #007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$function&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #DD0000">'closures'</span><span style="color: #007700">][</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addMethod</span><span style="color: #007700">(</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$function</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</span><span style="color: #0000BB">null&nbsp;</span><span style="color: #007700">===&nbsp;(</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">call_user_func_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">methods</span><span style="color: #007700">[</span><span style="color: #0000BB">$methodName</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$arguments</span><span style="color: #007700">))&nbsp;?&nbsp;</span><span style="color: #0000BB">$this&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\</span><span style="color: #0000BB">InvalidArgumentException</span><span style="color: #007700">(</span><span style="color: #DD0000">"There&nbsp;is&nbsp;valid&nbsp;method&nbsp;or&nbsp;closure&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;'</span><span style="color: #0000BB">$methodName</span><span style="color: #DD0000">'&nbsp;to&nbsp;call"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**&nbsp;Attempt&nbsp;to&nbsp;bind&nbsp;a&nbsp;closure&nbsp;to&nbsp;the&nbsp;working&nbsp;scope.&nbsp;This&nbsp;would&nbsp;mean&nbsp;the&nbsp;calling&nbsp;class<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;not&nbsp;the&nbsp;class&nbsp;which&nbsp;uses&nbsp;the&nbsp;Singelton&nbsp;trait<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$closure<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">addMethod</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$name</span><span style="color: #007700">,&nbsp;callable&nbsp;</span><span style="color: #0000BB">$closure</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">void<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">methods</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]&nbsp;=&nbsp;\</span><span style="color: #0000BB">Closure</span><span style="color: #007700">::</span><span style="color: #0000BB">bind</span><span style="color: #007700">(</span><span style="color: #0000BB">$closure</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">,&nbsp;static::class);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;If&nbsp;a&nbsp;previous&nbsp;class&nbsp;object&nbsp;was&nbsp;stored&nbsp;in&nbsp;our&nbsp;session&nbsp;then&nbsp;getInstance()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;will&nbsp;return&nbsp;the&nbsp;un-serialized&nbsp;object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__wakeup</span><span style="color: #007700">()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$object&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_object_vars</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$object&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$item&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Serialized</span><span style="color: #007700">::</span><span style="color: #0000BB">is_serialized</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$item</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">method_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'__construct'</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**&nbsp;Attempt&nbsp;to&nbsp;serialize&nbsp;the&nbsp;current&nbsp;class.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;array|null<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__sleep</span><span style="color: #007700">()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!\</span><span style="color: #0000BB">defined</span><span style="color: #007700">(</span><span style="color: #DD0000">'self::Singleton'</span><span style="color: #007700">)&nbsp;||&nbsp;!</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">Singleton</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">get_object_vars</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;&amp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(empty(</span><span style="color: #0000BB">$value</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;The&nbsp;object&nbsp;could&nbsp;be&nbsp;null&nbsp;from&nbsp;serialization?<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(\</span><span style="color: #0000BB">is_object</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;(@</span><span style="color: #0000BB">serialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(\</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Database&nbsp;object&nbsp;we&nbsp;need&nbsp;to&nbsp;catch&nbsp;the&nbsp;error&nbsp;thrown.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$onlyKeys</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$key</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$onlyKeys&nbsp;</span><span style="color: #007700">??&nbsp;[];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;Attempt&nbsp;to&nbsp;serialize&nbsp;the&nbsp;current&nbsp;class.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__destruct</span><span style="color: #007700">()<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;We&nbsp;require&nbsp;a&nbsp;sleep&nbsp;function&nbsp;to&nbsp;be&nbsp;set&nbsp;manually&nbsp;for&nbsp;singleton&nbsp;to&nbsp;manage&nbsp;utilization<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(!\</span><span style="color: #0000BB">defined</span><span style="color: #007700">(</span><span style="color: #DD0000">'self::Singleton'</span><span style="color: #007700">)&nbsp;||&nbsp;!</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">Singleton</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">]&nbsp;=&nbsp;@</span><span style="color: #0000BB">serialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;TODO&nbsp;-&nbsp;base64_encode(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;catch&nbsp;(\</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset(</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$variable&nbsp;a&nbsp;global&nbsp;variable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;&amp;</span><span style="color: #0000BB">__get</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$variable</span><span style="color: #007700">)&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;TODO&nbsp;-&nbsp;MAJOR&nbsp;rework,&nbsp;store&nbsp;in&nbsp;$storage<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #0000BB">$variable</span><span style="color: #007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$variable&nbsp;variable&nbsp;name&nbsp;to&nbsp;set&nbsp;to&nbsp;the&nbsp;global&nbsp;scope<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;mixed&nbsp;$value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__set</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$variable</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(\</span><span style="color: #0000BB">is_callable</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;{</span><span style="color: #0000BB">$variable</span><span style="color: #007700">}&nbsp;=&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindTo</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;preserves&nbsp;the&nbsp;'normal'&nbsp;new&nbsp;attribute&nbsp;closure&nbsp;binding<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #0000BB">$variable</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$variable&nbsp;check&nbsp;the&nbsp;global&nbsp;scope&nbsp;for&nbsp;the&nbsp;given&nbsp;variable&nbsp;name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__isset</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$variable</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">bool<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$variable</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$variable&nbsp;unset&nbsp;the&nbsp;variable&nbsp;from&nbsp;the&nbsp;global&nbsp;scope<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__unset</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$variable</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset(</span><span style="color: #0000BB">$GLOBALS</span><span style="color: #007700">[</span><span style="color: #0000BB">$variable</span><span style="color: #007700">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed&nbsp;the&nbsp;value(s)&nbsp;contained&nbsp;in&nbsp;our&nbsp;$storage&nbsp;attribute<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__invoke</span><span style="color: #007700">()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">storage</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;...$argv&nbsp;comma&nbsp;separated&nbsp;parameters&nbsp;to&nbsp;be&nbsp;set&nbsp;to&nbsp;the&nbsp;storage&nbsp;attribute<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;self<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">set</span><span style="color: #007700">(...</span><span style="color: #0000BB">$argv</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">self<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">storage&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$argv</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$variable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$variable&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</span><span style="color: #0000BB">$variable&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">null&nbsp;</span><span style="color: #007700">?<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">storage&nbsp;</span><span style="color: #007700">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;{</span><span style="color: #0000BB">$variable</span><span style="color: #007700">});<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$variable&nbsp;the&nbsp;variable&nbsp;name&nbsp;to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;lookup.&nbsp;Will&nbsp;return&nbsp;true&nbsp;if&nbsp;a&nbsp;variable&nbsp;matching&nbsp;the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;given&nbsp;param&nbsp;exists&nbsp;and&nbsp;is&nbsp;accessible&nbsp;in&nbsp;the&nbsp;global&nbsp;or<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;current&nbsp;scope.&nbsp;This&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;variable&nbsp;methods<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;added&nbsp;to&nbsp;the&nbsp;current&nbsp;scope&nbsp;via&nbsp;closures.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">has</span><span style="color: #007700">(</span><span style="color: #0000BB">string&nbsp;$variable</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">bool<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$variable</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></span>

</span></code></pre>
        </div>
    </div>
